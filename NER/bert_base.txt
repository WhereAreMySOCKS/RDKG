/home/guoshipeng/anaconda3/envs/python3.6/bin/python /home/guoshipeng/RDKG/NER/train.py
num_labels 是54
====================  Preparing for training  ====================
	* Loading training data...
数据集个数为402
输入例子
主诉：双眼无痛性视力下降半年
现病史：患者于半年前无明显诱因下出现双眼视力下降，无眼红、眼痛，无眼胀及头痛，无黑影飘动感及固定黑影遮挡，无视物变形及闪光感等不适，当时未予诊治，双眼视力逐渐下降。随后患者到当地医院就诊，具体诊疗经过不详，视力无提高。今患者为进一步诊治，到我院就诊，检查提示“双眼玻璃体混浊”，门诊拟“双眼玻璃体混浊：白塞病？”收入院治疗。
既往史：患者10年前在外院检查时发现“肝血管瘤”，但未予治疗，具体不详。5年前因“颈动脉狭窄”外院行“支架植入术”，术后长期口服药物治疗。否认高血压病史，否认糖尿病史，否认冠心病病史，否认结核病史,否认外伤史，有手术史，否认输血史，否认药物及食物过敏史，预防接种史不详。

attention_mask
tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1])
input_ids
tensor([ 101,  712, 6401, 8038, 1352, 4706, 3187, 4578, 2595, 6228, 1213,  678,
        7360, 1288, 2399,  100, 4385, 4567, 1380, 8038, 2642, 5442,  754, 1288,
        2399, 1184, 3187, 3209, 3227, 6430, 1728,  678, 1139, 4385, 1352, 4706,
        6228, 1213,  678, 7360, 8024, 3187, 4706, 5273,  510, 4706, 4578, 8024,
        3187, 4706, 5515, 1350, 1928, 4578, 8024, 3187, 7946, 2512, 7603, 1220,
        2697, 1350, 1743, 2137, 7946, 2512, 6902, 2913, 8024, 3187, 6228, 4289,
        1359, 2501, 1350, 7306, 1045, 2697, 5023,  679, 6844, 8024, 2496, 3198,
        3313,  750, 6402, 3780, 8024, 1352, 4706, 6228, 1213, 6852, 3933,  678,
        7360,  511, 7390, 1400, 2642, 5442, 1168, 2496, 1765, 1278, 7368, 2218,
        6402, 8024, 1072,  860, 6402, 4545, 5307, 6814,  679, 6422, 8024, 6228,
        1213, 3187, 2990, 7770,  511,  791, 2642, 5442,  711, 6822,  671, 3635,
        6402, 3780, 8024, 1168, 2769, 7368, 2218, 6402, 8024, 3466, 3389, 2990,
        4850,  100, 1352, 4706, 4390,  102])
labels
tensor([ 0,  0,  0,  6,  7,  0,  0,  0,  4,  5,  5,  5,  8,  9,  0,  0,  0,  0,
         0,  0,  0,  0,  8,  9,  0,  0,  0,  0,  0,  0,  0,  0,  0,  6,  7,  4,
         5,  5,  5,  0,  0, 10, 11,  0, 10, 11,  0,  0, 10, 11,  0, 10, 11,  0,
         0, 10, 11, 11, 11, 11,  0, 10, 11, 11, 11, 11, 11,  0,  0, 10, 11, 11,
        11,  0, 10, 11, 11,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  6,  7,
         4,  5,  5,  5,  5,  5,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
         0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
         0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
         0,  6,  7, 12, 13, 13])
实际序列转换后的长度为150, 设置最长为150
数据集个数为1607
输入例子
主诉：右眼视力下降伴视物遮挡1周
现病史：患者自诉1周前无明显诱因出现右眼视力下降伴视物遮挡，伴视物变形，不伴眼红、眼胀、眼痛，虹视等，无畏光、流泪，无头晕头痛等不适，症状持续未见好转，遂于当地医院就诊，考虑诊断“右眼视网膜脱离”建议至上级医院行手术治疗，现为求系统诊治，遂来我院门诊就诊。门诊医师检查后，诊断为“”收入院。
既往史：平素身体健康，否认“肝炎”、“结核”等慢性传染病史，否认糖尿病史,否认高血压史,否认外伤史，否认手术史，否认输血史，否认食物药物过敏史，预防接种史不详。

attention_mask
tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1])
input_ids
tensor([ 101,  712, 6401, 8038, 1381, 4706, 6228, 1213,  678, 7360,  845, 6228,
        4289, 6902, 2913,  122, 1453,  100, 4385, 4567, 1380, 8038, 2642, 5442,
        5632, 6401,  122, 1453, 1184, 3187, 3209, 3227, 6430, 1728, 1139, 4385,
        1381, 4706, 6228, 1213,  678, 7360,  845, 6228, 4289, 6902, 2913, 8024,
         845, 6228, 4289, 1359, 2501, 8024,  679,  845, 4706, 5273,  510, 4706,
        5515,  510, 4706, 4578, 8024, 6004, 6228, 5023, 8024, 3187, 4519, 1045,
         510, 3837, 3801, 8024, 3187, 1928, 3238, 1928, 4578, 5023,  679, 6844,
        8024, 4568, 4307, 2898, 5330, 3313, 6224, 1962, 6760, 8024, 6876,  754,
        2496, 1765, 1278, 7368, 2218, 6402, 8024, 5440, 5991, 6402, 3171,  100,
        1381, 4706, 6228, 5381, 5606, 5564, 4895,  100, 2456, 6379, 5635,  677,
        5277, 1278, 7368, 6121, 2797, 3318, 3780, 4545, 8024, 4385,  711, 3724,
        5143, 5320, 6402, 3780, 8024, 6876, 3341, 2769, 7368, 7305, 6402, 2218,
        6402,  511, 7305, 6402, 1278,  102])
labels
tensor([ 0,  0,  0,  6,  7,  4,  5,  5,  5,  5,  5,  5,  5,  5,  8,  9,  0,  0,
         0,  0,  0,  0,  0,  0,  0,  8,  9,  0,  0,  0,  0,  0,  0,  0,  0,  6,
         7,  4,  5,  5,  5,  5,  5,  5,  5,  5,  0,  0,  4,  5,  5,  5,  0,  0,
         0, 10, 11,  0, 10, 11,  0, 10, 11,  0, 10, 11,  0,  0,  0, 10, 11,  0,
        10, 11,  0,  0, 10, 11, 11, 11,  0,  0,  0,  0,  0,  0, 14, 15, 15, 15,
        15, 15,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  6,
         7, 12, 13, 13, 13, 13,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
         0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
         0,  0,  0,  0,  0,  0])
实际序列转换后的长度为150, 设置最长为150
	* Loading validation data...
	* Building model...
正在对验证集进行测试
  0%|          | 0/13 [00:00<?, ?it/s]{'acc': 0.0002050251668392295, 'recall': 0.0006581112207963146, 'f1': 0.00031264899678753154, 'num': 30390}
{'症状有': {'acc': 0.0, 'recall': 0.0, 'f1': 0.0, 'num': 6074}, '时长': {'acc': 0.0022, 'recall': 0.0026, 'f1': 0.0024, 'num': 3817}, '规律': {'acc': 0.0004, 'recall': 0.0056, 'f1': 0.0008, 'num': 1773}, '症状无': {'acc': 0.0, 'recall': 0.0, 'f1': 0.0, 'num': 10158}, '眼别': {'acc': 0.0, 'recall': 0.0, 'f1': 0.0, 'num': 4572}, '诱因': {'acc': 0.0, 'recall': 0.0, 'f1': 0.0, 'num': 320}, '部位': {'acc': 0.0, 'recall': 0.0, 'f1': 0.0, 'num': 98}, '操作或治疗有': {'acc': 0.0, 'recall': 0.0, 'f1': 0.0, 'num': 408}, '疾病有': {'acc': 0.0, 'recall': 0.0, 'f1': 0.0, 'num': 1135}, '药物有': {'acc': 0.0, 'recall': 0.0, 'f1': 0.0, 'num': 277}, '方位': {'acc': 0.0, 'recall': 0.0, 'f1': 0.0, 'num': 154}, '手术': {'acc': 0.0, 'recall': 0.0, 'f1': 0.0, 'num': 904}, '时间': {'acc': 0.0, 'recall': 0.0, 'f1': 0.0, 'num': 270}, '手术史有': {'acc': 0.0, 'recall': 0.0, 'f1': 0.0, 'num': 18}, '疾病无': {'acc': 0.0, 'recall': 0.0, 'f1': 0.0, 'num': 3}, '体征阳性': {'acc': 0.0, 'recall': 0.0, 'f1': 0.0, 'num': 231}, '拟行手术': {'acc': 0.0, 'recall': 0.0, 'f1': 0.0, 'num': 59}, '体征阴性': {'acc': 0.0, 'recall': 0.0, 'f1': 0.0, 'num': 25}, '检查项目': {'acc': 0.0, 'recall': 0.0, 'f1': 0.0, 'num': 44}, '检查结果阳性': {'acc': 0.0, 'recall': 0.0, 'f1': 0.0, 'num': 42}, '预防接种史有': {'acc': 0.0, 'recall': 0.0, 'f1': 0.0, 'num': 2}, '检查结果阴性': {'acc': 0.0, 'recall': 0.0, 'f1': 0.0, 'num': 6}}
before train-> Valid. time: 35.3761s, loss: 551.2817, f1_score: 0.0313%


 ==================== Training model on device: cuda:0 ====================
* Training epoch 1:
loss:117.8349609375: 100%|██████████| 13/13 [00:14<00:00,  1.15s/it]
-> Training time: 14.9553s, loss = 234.8635, accuracy:
* Validation for epoch 1:
正在对验证集进行测试
{'acc': 0.6588467048710601, 'recall': 0.48423823626192825, 'f1': 0.5582065774001441, 'num': 30390}
{'眼别': {'acc': 0.8963, 'recall': 0.6203, 'f1': 0.7332, 'num': 4572}, '规律': {'acc': 0, 'recall': 0.0, 'f1': 0.0, 'num': 1773}, '症状有': {'acc': 0.255, 'recall': 0.2399, 'f1': 0.2472, 'num': 6074}, '时长': {'acc': 0.8661, 'recall': 0.305, 'f1': 0.4511, 'num': 3817}, '症状无': {'acc': 0.7676, 'recall': 0.908, 'f1': 0.8319, 'num': 10158}, '诱因': {'acc': 0, 'recall': 0.0, 'f1': 0.0, 'num': 320}, '操作或治疗有': {'acc': 0, 'recall': 0.0, 'f1': 0.0, 'num': 408}, '检查结果阳性': {'acc': 0, 'recall': 0.0, 'f1': 0.0, 'num': 42}, '方位': {'acc': 0, 'recall': 0.0, 'f1': 0.0, 'num': 154}, '时间': {'acc': 0, 'recall': 0.0, 'f1': 0.0, 'num': 270}, '疾病有': {'acc': 0.36, 'recall': 0.0317, 'f1': 0.0583, 'num': 1135}, '拟行手术': {'acc': 0, 'recall': 0.0, 'f1': 0.0, 'num': 59}, '手术': {'acc': 0, 'recall': 0.0, 'f1': 0.0, 'num': 904}, '部位': {'acc': 0, 'recall': 0.0, 'f1': 0.0, 'num': 98}, '体征阳性': {'acc': 0, 'recall': 0.0, 'f1': 0.0, 'num': 231}, '药物有': {'acc': 0, 'recall': 0.0, 'f1': 0.0, 'num': 277}, '检查项目': {'acc': 0, 'recall': 0.0, 'f1': 0.0, 'num': 44}, '手术史有': {'acc': 0, 'recall': 0.0, 'f1': 0.0, 'num': 18}, '疾病无': {'acc': 0, 'recall': 0.0, 'f1': 0.0, 'num': 3}, '体征阴性': {'acc': 0, 'recall': 0.0, 'f1': 0.0, 'num': 25}, '检查结果阴性': {'acc': 0, 'recall': 0.0, 'f1': 0.0, 'num': 6}, '预防接种史有': {'acc': 0, 'recall': 0.0, 'f1': 0.0, 'num': 2}}
-> Valid. time: 33.5507s, loss: 92.6700, f1_score: 55.8207%

save model
* Training epoch 2:
loss:38.70009994506836: 100%|██████████| 13/13 [00:15<00:00,  1.16s/it]
-> Training time: 15.0251s, loss = 62.6339, accuracy:
* Validation for epoch 2:
正在对验证集进行测试
{'acc': 0.8469212362239223, 'recall': 0.8268838433695295, 'f1': 0.8367826043522419, 'num': 30390}
{'眼别': {'acc': 0.8465, 'recall': 0.9744, 'f1': 0.9059, 'num': 4572}, '诱因': {'acc': 0, 'recall': 0.0, 'f1': 0.0, 'num': 320}, '症状有': {'acc': 0.7358, 'recall': 0.8345, 'f1': 0.7821, 'num': 6074}, '时长': {'acc': 0.8769, 'recall': 0.9591, 'f1': 0.9162, 'num': 3817}, '症状无': {'acc': 0.964, 'recall': 0.9741, 'f1': 0.969, 'num': 10158}, '疾病有': {'acc': 0.8208, 'recall': 0.6053, 'f1': 0.6968, 'num': 1135}, '体征阳性': {'acc': 0, 'recall': 0.0, 'f1': 0.0, 'num': 231}, '检查项目': {'acc': 0, 'recall': 0.0, 'f1': 0.0, 'num': 44}, '检查结果阳性': {'acc': 0, 'recall': 0.0, 'f1': 0.0, 'num': 42}, '药物有': {'acc': 0.7722, 'recall': 0.2202, 'f1': 0.3427, 'num': 277}, '规律': {'acc': 0.5156, 'recall': 0.3271, 'f1': 0.4003, 'num': 1773}, '手术': {'acc': 0.7713, 'recall': 0.7423, 'f1': 0.7565, 'num': 904}, '拟行手术': {'acc': 0, 'recall': 0.0, 'f1': 0.0, 'num': 59}, '时间': {'acc': 0, 'recall': 0.0, 'f1': 0.0, 'num': 270}, '操作或治疗有': {'acc': 0.2976, 'recall': 0.1225, 'f1': 0.1736, 'num': 408}, '体征阴性': {'acc': 0, 'recall': 0.0, 'f1': 0.0, 'num': 25}, '手术史有': {'acc': 0, 'recall': 0.0, 'f1': 0.0, 'num': 18}, '部位': {'acc': 0, 'recall': 0.0, 'f1': 0.0, 'num': 98}, '方位': {'acc': 0, 'recall': 0.0, 'f1': 0.0, 'num': 154}, '检查结果阴性': {'acc': 0, 'recall': 0.0, 'f1': 0.0, 'num': 6}, '疾病无': {'acc': 0, 'recall': 0.0, 'f1': 0.0, 'num': 3}, '预防接种史有': {'acc': 0, 'recall': 0.0, 'f1': 0.0, 'num': 2}}
-> Valid. time: 32.9556s, loss: 39.8278, f1_score: 83.6783%

save model
* Training epoch 3:
loss:18.751916885375977: 100%|██████████| 13/13 [00:14<00:00,  1.14s/it]
-> Training time: 14.8267s, loss = 31.4765, accuracy:
* Validation for epoch 3:
正在对验证集进行测试
{'acc': 0.8677580211272227, 'recall': 0.8703849950641659, 'f1': 0.8690695229333684, 'num': 30390}
{'眼别': {'acc': 0.8892, 'recall': 0.9762, 'f1': 0.9307, 'num': 4572}, '症状有': {'acc': 0.8153, 'recall': 0.8624, 'f1': 0.8381, 'num': 6074}, '时长': {'acc': 0.8968, 'recall': 0.9562, 'f1': 0.9256, 'num': 3817}, '规律': {'acc': 0.5539, 'recall': 0.5183, 'f1': 0.5355, 'num': 1773}, '症状无': {'acc': 0.974, 'recall': 0.9871, 'f1': 0.9805, 'num': 10158}, '时间': {'acc': 0.6238, 'recall': 0.2333, 'f1': 0.3396, 'num': 270}, '疾病有': {'acc': 0.7901, 'recall': 0.8687, 'f1': 0.8275, 'num': 1135}, '手术': {'acc': 0.7939, 'recall': 0.8396, 'f1': 0.8161, 'num': 904}, '药物有': {'acc': 0.6423, 'recall': 0.6029, 'f1': 0.622, 'num': 277}, '操作或治疗有': {'acc': 0.3912, 'recall': 0.3701, 'f1': 0.3804, 'num': 408}, '诱因': {'acc': 0.4444, 'recall': 0.0875, 'f1': 0.1462, 'num': 320}, '拟行手术': {'acc': 0, 'recall': 0.0, 'f1': 0.0, 'num': 59}, '体征阳性': {'acc': 0, 'recall': 0.0, 'f1': 0.0, 'num': 231}, '检查项目': {'acc': 0, 'recall': 0.0, 'f1': 0.0, 'num': 44}, '部位': {'acc': 0, 'recall': 0.0, 'f1': 0.0, 'num': 98}, '方位': {'acc': 0, 'recall': 0.0, 'f1': 0.0, 'num': 154}, '手术史有': {'acc': 0, 'recall': 0.0, 'f1': 0.0, 'num': 18}, '检查结果阳性': {'acc': 0, 'recall': 0.0, 'f1': 0.0, 'num': 42}, '体征阴性': {'acc': 0, 'recall': 0.0, 'f1': 0.0, 'num': 25}, '预防接种史有': {'acc': 0, 'recall': 0.0, 'f1': 0.0, 'num': 2}, '疾病无': {'acc': 0, 'recall': 0.0, 'f1': 0.0, 'num': 3}, '检查结果阴性': {'acc': 0, 'recall': 0.0, 'f1': 0.0, 'num': 6}}
-> Valid. time: 33.0926s, loss: 30.3958, f1_score: 86.9070%

save model
* Training epoch 4:
loss:12.296807289123535: 100%|██████████| 13/13 [00:14<00:00,  1.14s/it]
-> Training time: 14.8328s, loss = 21.2144, accuracy:
* Validation for epoch 4:
正在对验证集进行测试
{'acc': 0.8653970095385408, 'recall': 0.8836788417242514, 'f1': 0.8744423822083293, 'num': 30390}
{'眼别': {'acc': 0.9334, 'recall': 0.9742, 'f1': 0.9533, 'num': 4572}, '手术': {'acc': 0.7971, 'recall': 0.8429, 'f1': 0.8194, 'num': 904}, '时长': {'acc': 0.9092, 'recall': 0.9597, 'f1': 0.9337, 'num': 3817}, '时间': {'acc': 0.6124, 'recall': 0.2926, 'f1': 0.396, 'num': 270}, '疾病有': {'acc': 0.8463, 'recall': 0.8881, 'f1': 0.8667, 'num': 1135}, '药物有': {'acc': 0.6892, 'recall': 0.7365, 'f1': 0.712, 'num': 277}, '规律': {'acc': 0.5208, 'recall': 0.6503, 'f1': 0.5784, 'num': 1773}, '症状无': {'acc': 0.9708, 'recall': 0.984, 'f1': 0.9773, 'num': 10158}, '症状有': {'acc': 0.8223, 'recall': 0.8668, 'f1': 0.844, 'num': 6074}, '体征阳性': {'acc': 0.4286, 'recall': 0.0779, 'f1': 0.1319, 'num': 231}, '诱因': {'acc': 0.3245, 'recall': 0.3063, 'f1': 0.3151, 'num': 320}, '部位': {'acc': 0.125, 'recall': 0.0204, 'f1': 0.0351, 'num': 98}, '拟行手术': {'acc': 0, 'recall': 0.0, 'f1': 0.0, 'num': 59}, '操作或治疗有': {'acc': 0.4011, 'recall': 0.3431, 'f1': 0.3699, 'num': 408}, '检查项目': {'acc': 0, 'recall': 0.0, 'f1': 0.0, 'num': 44}, '体征阴性': {'acc': 0, 'recall': 0.0, 'f1': 0.0, 'num': 25}, '方位': {'acc': 0.4375, 'recall': 0.0909, 'f1': 0.1505, 'num': 154}, '手术史有': {'acc': 0, 'recall': 0.0, 'f1': 0.0, 'num': 18}, '检查结果阳性': {'acc': 0.0, 'recall': 0.0, 'f1': 0.0, 'num': 42}, '预防接种史有': {'acc': 0, 'recall': 0.0, 'f1': 0.0, 'num': 2}, '检查结果阴性': {'acc': 0, 'recall': 0.0, 'f1': 0.0, 'num': 6}, '疾病无': {'acc': 0, 'recall': 0.0, 'f1': 0.0, 'num': 3}}
-> Valid. time: 32.0780s, loss: 27.2759, f1_score: 87.4442%

save model
* Training epoch 5:
loss:9.762688636779785: 100%|██████████| 13/13 [00:14<00:00,  1.15s/it]
-> Training time: 14.8862s, loss = 15.8603, accuracy:
* Validation for epoch 5:
正在对验证集进行测试
{'acc': 0.8648225636439135, 'recall': 0.8909180651530109, 'f1': 0.8776763862100264, 'num': 30390}
{'时长': {'acc': 0.9147, 'recall': 0.9521, 'f1': 0.933, 'num': 3817}, '眼别': {'acc': 0.9497, 'recall': 0.9744, 'f1': 0.9619, 'num': 4572}, '疾病有': {'acc': 0.8736, 'recall': 0.889, 'f1': 0.8812, 'num': 1135}, '手术': {'acc': 0.8227, 'recall': 0.8573, 'f1': 0.8397, 'num': 904}, '药物有': {'acc': 0.7013, 'recall': 0.7798, 'f1': 0.7385, 'num': 277}, '症状有': {'acc': 0.8305, 'recall': 0.8742, 'f1': 0.8518, 'num': 6074}, '症状无': {'acc': 0.9802, 'recall': 0.9869, 'f1': 0.9836, 'num': 10158}, '规律': {'acc': 0.4861, 'recall': 0.6915, 'f1': 0.5709, 'num': 1773}, '操作或治疗有': {'acc': 0.3948, 'recall': 0.3725, 'f1': 0.3834, 'num': 408}, '时间': {'acc': 0.5588, 'recall': 0.4222, 'f1': 0.481, 'num': 270}, '方位': {'acc': 0.5439, 'recall': 0.2013, 'f1': 0.2938, 'num': 154}, '体征阳性': {'acc': 0.3611, 'recall': 0.1126, 'f1': 0.1716, 'num': 231}, '诱因': {'acc': 0.2898, 'recall': 0.2844, 'f1': 0.2871, 'num': 320}, '拟行手术': {'acc': 0.3333, 'recall': 0.1017, 'f1': 0.1558, 'num': 59}, '部位': {'acc': 0.1667, 'recall': 0.0306, 'f1': 0.0517, 'num': 98}, '检查项目': {'acc': 0.0833, 'recall': 0.0227, 'f1': 0.0357, 'num': 44}, '预防接种史有': {'acc': 0, 'recall': 0.0, 'f1': 0.0, 'num': 2}, '检查结果阳性': {'acc': 0.0667, 'recall': 0.0238, 'f1': 0.0351, 'num': 42}, '检查结果阴性': {'acc': 0, 'recall': 0.0, 'f1': 0.0, 'num': 6}, '手术史有': {'acc': 0, 'recall': 0.0, 'f1': 0.0, 'num': 18}, '体征阴性': {'acc': 0, 'recall': 0.0, 'f1': 0.0, 'num': 25}, '疾病无': {'acc': 0, 'recall': 0.0, 'f1': 0.0, 'num': 3}}
-> Valid. time: 32.5438s, loss: 26.0137, f1_score: 87.7676%

save model
  0%|          | 0/13 [00:00<?, ?it/s]* Training epoch 6:
loss:14.878254890441895: 100%|██████████| 13/13 [00:14<00:00,  1.14s/it]
-> Training time: 14.8184s, loss = 12.6273, accuracy:
* Validation for epoch 6:
正在对验证集进行测试
{'acc': 0.8840395342009981, 'recall': 0.8918065153010859, 'f1': 0.8879060396088261, 'num': 30390}
{'眼别': {'acc': 0.9484, 'recall': 0.9777, 'f1': 0.9628, 'num': 4572}, '疾病有': {'acc': 0.8852, 'recall': 0.8899, 'f1': 0.8875, 'num': 1135}, '时长': {'acc': 0.9173, 'recall': 0.9649, 'f1': 0.9405, 'num': 3817}, '症状无': {'acc': 0.9776, 'recall': 0.9878, 'f1': 0.9827, 'num': 10158}, '症状有': {'acc': 0.849, 'recall': 0.882, 'f1': 0.8651, 'num': 6074}, '规律': {'acc': 0.5695, 'recall': 0.6402, 'f1': 0.6028, 'num': 1773}, '诱因': {'acc': 0.3577, 'recall': 0.275, 'f1': 0.311, 'num': 320}, '部位': {'acc': 0.0, 'recall': 0.0, 'f1': 0.0, 'num': 98}, '操作或治疗有': {'acc': 0.4135, 'recall': 0.4044, 'f1': 0.4089, 'num': 408}, '方位': {'acc': 0.55, 'recall': 0.2143, 'f1': 0.3084, 'num': 154}, '体征阳性': {'acc': 0.4, 'recall': 0.1732, 'f1': 0.2417, 'num': 231}, '时间': {'acc': 0.6111, 'recall': 0.2852, 'f1': 0.3889, 'num': 270}, '手术': {'acc': 0.8266, 'recall': 0.8595, 'f1': 0.8427, 'num': 904}, '药物有': {'acc': 0.7649, 'recall': 0.787, 'f1': 0.7758, 'num': 277}, '检查结果阳性': {'acc': 0.2, 'recall': 0.0714, 'f1': 0.1053, 'num': 42}, '体征阴性': {'acc': 0, 'recall': 0.0, 'f1': 0.0, 'num': 25}, '拟行手术': {'acc': 0.4167, 'recall': 0.1695, 'f1': 0.241, 'num': 59}, '手术史有': {'acc': 0, 'recall': 0.0, 'f1': 0.0, 'num': 18}, '检查项目': {'acc': 0.1176, 'recall': 0.0455, 'f1': 0.0656, 'num': 44}, '检查结果阴性': {'acc': 0, 'recall': 0.0, 'f1': 0.0, 'num': 6}, '疾病无': {'acc': 0, 'recall': 0.0, 'f1': 0.0, 'num': 3}, '预防接种史有': {'acc': 0, 'recall': 0.0, 'f1': 0.0, 'num': 2}}
-> Valid. time: 33.4262s, loss: 26.5395, f1_score: 88.7906%

save model
  0%|          | 0/13 [00:00<?, ?it/s]* Training epoch 7:
loss:7.034451007843018: 100%|██████████| 13/13 [00:14<00:00,  1.15s/it]
-> Training time: 14.8958s, loss = 9.9601, accuracy:
* Validation for epoch 7:
正在对验证集进行测试
{'acc': 0.8794671655270287, 'recall': 0.8972359328726555, 'f1': 0.8882626966804573, 'num': 30390}
{'眼别': {'acc': 0.9411, 'recall': 0.9783, 'f1': 0.9594, 'num': 4572}, '诱因': {'acc': 0.3767, 'recall': 0.3531, 'f1': 0.3645, 'num': 320}, '症状有': {'acc': 0.8567, 'recall': 0.8905, 'f1': 0.8733, 'num': 6074}, '时长': {'acc': 0.9201, 'recall': 0.9536, 'f1': 0.9366, 'num': 3817}, '症状无': {'acc': 0.9829, 'recall': 0.9873, 'f1': 0.9851, 'num': 10158}, '操作或治疗有': {'acc': 0.3728, 'recall': 0.3701, 'f1': 0.3715, 'num': 408}, '药物有': {'acc': 0.7475, 'recall': 0.8123, 'f1': 0.7785, 'num': 277}, '规律': {'acc': 0.5602, 'recall': 0.6689, 'f1': 0.6098, 'num': 1773}, '方位': {'acc': 0.5352, 'recall': 0.2468, 'f1': 0.3378, 'num': 154}, '部位': {'acc': 0.18, 'recall': 0.0918, 'f1': 0.1216, 'num': 98}, '体征阳性': {'acc': 0.4176, 'recall': 0.1645, 'f1': 0.236, 'num': 231}, '疾病有': {'acc': 0.8831, 'recall': 0.8987, 'f1': 0.8908, 'num': 1135}, '手术': {'acc': 0.8133, 'recall': 0.8772, 'f1': 0.8441, 'num': 904}, '时间': {'acc': 0.5817, 'recall': 0.4481, 'f1': 0.5063, 'num': 270}, '拟行手术': {'acc': 0.3947, 'recall': 0.2542, 'f1': 0.3093, 'num': 59}, '检查项目': {'acc': 0.1579, 'recall': 0.1364, 'f1': 0.1463, 'num': 44}, '手术史有': {'acc': 0, 'recall': 0.0, 'f1': 0.0, 'num': 18}, '检查结果阳性': {'acc': 0.04, 'recall': 0.0238, 'f1': 0.0299, 'num': 42}, '体征阴性': {'acc': 0.0, 'recall': 0.0, 'f1': 0.0, 'num': 25}, '检查结果阴性': {'acc': 0, 'recall': 0.0, 'f1': 0.0, 'num': 6}, '疾病无': {'acc': 0, 'recall': 0.0, 'f1': 0.0, 'num': 3}, '预防接种史有': {'acc': 0.0, 'recall': 0.0, 'f1': 0.0, 'num': 2}}
-> Valid. time: 33.2350s, loss: 28.1719, f1_score: 88.8263%

save model
* Training epoch 8:
loss:6.954264163970947: 100%|██████████| 13/13 [00:14<00:00,  1.14s/it]
-> Training time: 14.8398s, loss = 8.6770, accuracy:
* Validation for epoch 8:
正在对验证集进行测试
{'acc': 0.8792209882504426, 'recall': 0.898749588680487, 'f1': 0.8888780408428932, 'num': 30390}
{'眼别': {'acc': 0.9517, 'recall': 0.9777, 'f1': 0.9645, 'num': 4572}, '手术': {'acc': 0.8411, 'recall': 0.8606, 'f1': 0.8507, 'num': 904}, '时长': {'acc': 0.9172, 'recall': 0.9581, 'f1': 0.9372, 'num': 3817}, '体征阳性': {'acc': 0.4406, 'recall': 0.2727, 'f1': 0.3369, 'num': 231}, '时间': {'acc': 0.5517, 'recall': 0.4741, 'f1': 0.51, 'num': 270}, '疾病有': {'acc': 0.8811, 'recall': 0.9075, 'f1': 0.8941, 'num': 1135}, '症状无': {'acc': 0.971, 'recall': 0.9886, 'f1': 0.9797, 'num': 10158}, '规律': {'acc': 0.573, 'recall': 0.6949, 'f1': 0.6281, 'num': 1773}, '症状有': {'acc': 0.8594, 'recall': 0.8769, 'f1': 0.8681, 'num': 6074}, '方位': {'acc': 0.5679, 'recall': 0.2987, 'f1': 0.3915, 'num': 154}, '药物有': {'acc': 0.7865, 'recall': 0.7978, 'f1': 0.7921, 'num': 277}, '诱因': {'acc': 0.3834, 'recall': 0.375, 'f1': 0.3791, 'num': 320}, '操作或治疗有': {'acc': 0.3906, 'recall': 0.4289, 'f1': 0.4089, 'num': 408}, '部位': {'acc': 0.2414, 'recall': 0.0714, 'f1': 0.1102, 'num': 98}, '检查项目': {'acc': 0.2069, 'recall': 0.1364, 'f1': 0.1644, 'num': 44}, '体征阴性': {'acc': 0, 'recall': 0.0, 'f1': 0.0, 'num': 25}, '检查结果阳性': {'acc': 0.2222, 'recall': 0.0476, 'f1': 0.0784, 'num': 42}, '拟行手术': {'acc': 0.3704, 'recall': 0.1695, 'f1': 0.2326, 'num': 59}, '手术史有': {'acc': 0, 'recall': 0.0, 'f1': 0.0, 'num': 18}, '检查结果阴性': {'acc': 0, 'recall': 0.0, 'f1': 0.0, 'num': 6}, '预防接种史有': {'acc': 0.0, 'recall': 0.0, 'f1': 0.0, 'num': 2}, '疾病无': {'acc': 0, 'recall': 0.0, 'f1': 0.0, 'num': 3}}
-> Valid. time: 32.9801s, loss: 28.0058, f1_score: 88.8878%

save model
* Training epoch 9:
loss:6.670450687408447: 100%|██████████| 13/13 [00:14<00:00,  1.14s/it]
-> Training time: 14.8828s, loss = 7.4294, accuracy:
* Validation for epoch 9:
正在对验证集进行测试
{'acc': 0.8846741426946205, 'recall': 0.8955906548206647, 'f1': 0.890098928951026, 'num': 30390}
{'眼别': {'acc': 0.9554, 'recall': 0.9755, 'f1': 0.9654, 'num': 4572}, '症状有': {'acc': 0.8653, 'recall': 0.8798, 'f1': 0.8725, 'num': 6074}, '时长': {'acc': 0.9272, 'recall': 0.9473, 'f1': 0.9372, 'num': 3817}, '症状无': {'acc': 0.9798, 'recall': 0.9878, 'f1': 0.9838, 'num': 10158}, '操作或治疗有': {'acc': 0.4593, 'recall': 0.4289, 'f1': 0.4436, 'num': 408}, '规律': {'acc': 0.5748, 'recall': 0.6785, 'f1': 0.6223, 'num': 1773}, '诱因': {'acc': 0.3763, 'recall': 0.3281, 'f1': 0.3506, 'num': 320}, '疾病有': {'acc': 0.8862, 'recall': 0.8855, 'f1': 0.8859, 'num': 1135}, '拟行手术': {'acc': 0.4242, 'recall': 0.2373, 'f1': 0.3043, 'num': 59}, '方位': {'acc': 0.5556, 'recall': 0.3247, 'f1': 0.4098, 'num': 154}, '药物有': {'acc': 0.7508, 'recall': 0.8159, 'f1': 0.782, 'num': 277}, '手术': {'acc': 0.8094, 'recall': 0.8783, 'f1': 0.8424, 'num': 904}, '时间': {'acc': 0.5166, 'recall': 0.5185, 'f1': 0.5176, 'num': 270}, '部位': {'acc': 0.3333, 'recall': 0.1327, 'f1': 0.1898, 'num': 98}, '手术史有': {'acc': 0, 'recall': 0.0, 'f1': 0.0, 'num': 18}, '体征阳性': {'acc': 0.3553, 'recall': 0.1169, 'f1': 0.1759, 'num': 231}, '检查项目': {'acc': 0.1818, 'recall': 0.1364, 'f1': 0.1558, 'num': 44}, '检查结果阳性': {'acc': 0.0909, 'recall': 0.0952, 'f1': 0.093, 'num': 42}, '体征阴性': {'acc': 0.0667, 'recall': 0.04, 'f1': 0.05, 'num': 25}, '疾病无': {'acc': 0, 'recall': 0.0, 'f1': 0.0, 'num': 3}, '检查结果阴性': {'acc': 0, 'recall': 0.0, 'f1': 0.0, 'num': 6}, '预防接种史有': {'acc': 0.0, 'recall': 0.0, 'f1': 0.0, 'num': 2}}
-> Valid. time: 33.0983s, loss: 29.4976, f1_score: 89.0099%

save model
* Training epoch 10:
loss:11.81346321105957: 100%|██████████| 13/13 [00:14<00:00,  1.14s/it]
-> Training time: 14.7774s, loss = 6.4638, accuracy:
* Validation for epoch 10:
正在对验证集进行测试
{'acc': 0.8842859469141834, 'recall': 0.8934517933530767, 'f1': 0.8888452410180866, 'num': 30390}
{'症状有': {'acc': 0.8712, 'recall': 0.8734, 'f1': 0.8723, 'num': 6074}, '时长': {'acc': 0.9469, 'recall': 0.9156, 'f1': 0.931, 'num': 3817}, '规律': {'acc': 0.5764, 'recall': 0.6892, 'f1': 0.6278, 'num': 1773}, '症状无': {'acc': 0.9772, 'recall': 0.9884, 'f1': 0.9828, 'num': 10158}, '疾病有': {'acc': 0.8763, 'recall': 0.9048, 'f1': 0.8903, 'num': 1135}, '眼别': {'acc': 0.9567, 'recall': 0.977, 'f1': 0.9668, 'num': 4572}, '诱因': {'acc': 0.3497, 'recall': 0.3344, 'f1': 0.3419, 'num': 320}, '部位': {'acc': 0.3158, 'recall': 0.1224, 'f1': 0.1765, 'num': 98}, '操作或治疗有': {'acc': 0.4581, 'recall': 0.4289, 'f1': 0.443, 'num': 408}, '手术': {'acc': 0.8423, 'recall': 0.8684, 'f1': 0.8551, 'num': 904}, '检查结果阳性': {'acc': 0.0645, 'recall': 0.0476, 'f1': 0.0548, 'num': 42}, '时间': {'acc': 0.4076, 'recall': 0.6778, 'f1': 0.509, 'num': 270}, '体征阳性': {'acc': 0.3981, 'recall': 0.1775, 'f1': 0.2455, 'num': 231}, '方位': {'acc': 0.5698, 'recall': 0.3182, 'f1': 0.4083, 'num': 154}, '检查项目': {'acc': 0.12, 'recall': 0.0682, 'f1': 0.087, 'num': 44}, '拟行手术': {'acc': 0.4286, 'recall': 0.2542, 'f1': 0.3191, 'num': 59}, '预防接种史有': {'acc': 0.0, 'recall': 0.0, 'f1': 0.0, 'num': 2}, '药物有': {'acc': 0.7751, 'recall': 0.8087, 'f1': 0.7915, 'num': 277}, '体征阴性': {'acc': 0.0, 'recall': 0.0, 'f1': 0.0, 'num': 25}, '手术史有': {'acc': 0, 'recall': 0.0, 'f1': 0.0, 'num': 18}, '检查结果阴性': {'acc': 0, 'recall': 0.0, 'f1': 0.0, 'num': 6}, '疾病无': {'acc': 0, 'recall': 0.0, 'f1': 0.0, 'num': 3}}
-> Valid. time: 32.9971s, loss: 32.1651, f1_score: 88.8845%

* Training epoch 11:
loss:6.898044109344482: 100%|██████████| 13/13 [00:15<00:00,  1.15s/it]
-> Training time: 15.0109s, loss = 5.5722, accuracy:
* Validation for epoch 11:
正在对验证集进行测试
{'acc': 0.8890188054175192, 'recall': 0.9006910167818362, 'f1': 0.8948168489187466, 'num': 30390}
{'眼别': {'acc': 0.9524, 'recall': 0.9794, 'f1': 0.9657, 'num': 4572}, '症状有': {'acc': 0.8722, 'recall': 0.8797, 'f1': 0.8759, 'num': 6074}, '时长': {'acc': 0.928, 'recall': 0.956, 'f1': 0.9418, 'num': 3817}, '症状无': {'acc': 0.9802, 'recall': 0.9884, 'f1': 0.9843, 'num': 10158}, '体征阳性': {'acc': 0.4631, 'recall': 0.2987, 'f1': 0.3632, 'num': 231}, '规律': {'acc': 0.6113, 'recall': 0.6813, 'f1': 0.6444, 'num': 1773}, '疾病有': {'acc': 0.883, 'recall': 0.911, 'f1': 0.8968, 'num': 1135}, '手术': {'acc': 0.8462, 'recall': 0.8706, 'f1': 0.8582, 'num': 904}, '药物有': {'acc': 0.7958, 'recall': 0.8159, 'f1': 0.8057, 'num': 277}, '拟行手术': {'acc': 0.3913, 'recall': 0.3051, 'f1': 0.3429, 'num': 59}, '操作或治疗有': {'acc': 0.4394, 'recall': 0.4265, 'f1': 0.4328, 'num': 408}, '手术史有': {'acc': 0.0, 'recall': 0.0, 'f1': 0.0, 'num': 18}, '预防接种史有': {'acc': 0.0, 'recall': 0.0, 'f1': 0.0, 'num': 2}, '方位': {'acc': 0.5534, 'recall': 0.3701, 'f1': 0.4436, 'num': 154}, '检查项目': {'acc': 0.1053, 'recall': 0.1364, 'f1': 0.1188, 'num': 44}, '检查结果阳性': {'acc': 0.05, 'recall': 0.0476, 'f1': 0.0488, 'num': 42}, '时间': {'acc': 0.5556, 'recall': 0.5185, 'f1': 0.5364, 'num': 270}, '诱因': {'acc': 0.412, 'recall': 0.3875, 'f1': 0.3994, 'num': 320}, '检查结果阴性': {'acc': 0, 'recall': 0.0, 'f1': 0.0, 'num': 6}, '体征阴性': {'acc': 0.125, 'recall': 0.04, 'f1': 0.0606, 'num': 25}, '部位': {'acc': 0.2623, 'recall': 0.1633, 'f1': 0.2013, 'num': 98}, '疾病无': {'acc': 0, 'recall': 0.0, 'f1': 0.0, 'num': 3}}
-> Valid. time: 33.8860s, loss: 30.2328, f1_score: 89.4817%

save model
* Training epoch 12:
loss:6.777018070220947: 100%|██████████| 13/13 [00:14<00:00,  1.14s/it]
-> Training time: 14.7997s, loss = 4.9133, accuracy:
* Validation for epoch 12:
正在对验证集进行测试
{'acc': 0.8941426007505303, 'recall': 0.9016452780519908, 'f1': 0.8978782665683624, 'num': 30390}
{'眼别': {'acc': 0.9437, 'recall': 0.9818, 'f1': 0.9624, 'num': 4572}, '症状有': {'acc': 0.8892, 'recall': 0.8917, 'f1': 0.8904, 'num': 6074}, '时长': {'acc': 0.9123, 'recall': 0.9707, 'f1': 0.9406, 'num': 3817}, '症状无': {'acc': 0.983, 'recall': 0.9886, 'f1': 0.9858, 'num': 10158}, '规律': {'acc': 0.6275, 'recall': 0.6565, 'f1': 0.6417, 'num': 1773}, '体征阳性': {'acc': 0.4198, 'recall': 0.2944, 'f1': 0.3461, 'num': 231}, '体征阴性': {'acc': 0.0, 'recall': 0.0, 'f1': 0.0, 'num': 25}, '方位': {'acc': 0.5833, 'recall': 0.3182, 'f1': 0.4118, 'num': 154}, '手术': {'acc': 0.8599, 'recall': 0.8761, 'f1': 0.8679, 'num': 904}, '疾病有': {'acc': 0.8671, 'recall': 0.9137, 'f1': 0.8897, 'num': 1135}, '拟行手术': {'acc': 0.3261, 'recall': 0.2542, 'f1': 0.2857, 'num': 59}, '诱因': {'acc': 0.3579, 'recall': 0.3344, 'f1': 0.3457, 'num': 320}, '时间': {'acc': 0.7031, 'recall': 0.3333, 'f1': 0.4523, 'num': 270}, '操作或治疗有': {'acc': 0.4365, 'recall': 0.4461, 'f1': 0.4412, 'num': 408}, '检查结果阳性': {'acc': 0.0667, 'recall': 0.0476, 'f1': 0.0556, 'num': 42}, '检查结果阴性': {'acc': 0, 'recall': 0.0, 'f1': 0.0, 'num': 6}, '药物有': {'acc': 0.7972, 'recall': 0.8231, 'f1': 0.8099, 'num': 277}, '部位': {'acc': 0.2432, 'recall': 0.0918, 'f1': 0.1333, 'num': 98}, '检查项目': {'acc': 0.0882, 'recall': 0.0682, 'f1': 0.0769, 'num': 44}, '手术史有': {'acc': 0.6, 'recall': 0.1667, 'f1': 0.2609, 'num': 18}, '疾病无': {'acc': 0, 'recall': 0.0, 'f1': 0.0, 'num': 3}, '预防接种史有': {'acc': 0.0, 'recall': 0.0, 'f1': 0.0, 'num': 2}}
-> Valid. time: 33.0785s, loss: 31.7981, f1_score: 89.7878%

save model
  0%|          | 0/13 [00:00<?, ?it/s]* Training epoch 13:
loss:4.745645999908447: 100%|██████████| 13/13 [00:14<00:00,  1.12s/it]
-> Training time: 14.6099s, loss = 4.3962, accuracy:
* Validation for epoch 13:
正在对验证集进行测试
{'acc': 0.8826563507414571, 'recall': 0.9009542612701547, 'f1': 0.891711447646963, 'num': 30390}
{'眼别': {'acc': 0.9553, 'recall': 0.9729, 'f1': 0.964, 'num': 4572}, '疾病有': {'acc': 0.8847, 'recall': 0.9057, 'f1': 0.8951, 'num': 1135}, '手术': {'acc': 0.8536, 'recall': 0.8838, 'f1': 0.8685, 'num': 904}, '时长': {'acc': 0.931, 'recall': 0.9431, 'f1': 0.937, 'num': 3817}, '症状无': {'acc': 0.9812, 'recall': 0.9887, 'f1': 0.9849, 'num': 10158}, '规律': {'acc': 0.5868, 'recall': 0.6994, 'f1': 0.6382, 'num': 1773}, '症状有': {'acc': 0.8579, 'recall': 0.8936, 'f1': 0.8754, 'num': 6074}, '诱因': {'acc': 0.3622, 'recall': 0.3656, 'f1': 0.3639, 'num': 320}, '部位': {'acc': 0.2188, 'recall': 0.0714, 'f1': 0.1077, 'num': 98}, '体征阳性': {'acc': 0.4811, 'recall': 0.2208, 'f1': 0.3027, 'num': 231}, '药物有': {'acc': 0.7362, 'recall': 0.8159, 'f1': 0.774, 'num': 277}, '时间': {'acc': 0.4762, 'recall': 0.5556, 'f1': 0.5128, 'num': 270}, '拟行手术': {'acc': 0.4545, 'recall': 0.2542, 'f1': 0.3261, 'num': 59}, '操作或治疗有': {'acc': 0.3972, 'recall': 0.4216, 'f1': 0.409, 'num': 408}, '方位': {'acc': 0.5556, 'recall': 0.2922, 'f1': 0.383, 'num': 154}, '体征阴性': {'acc': 0.1667, 'recall': 0.04, 'f1': 0.0645, 'num': 25}, '检查项目': {'acc': 0.1818, 'recall': 0.1364, 'f1': 0.1558, 'num': 44}, '检查结果阳性': {'acc': 0.04, 'recall': 0.0238, 'f1': 0.0299, 'num': 42}, '手术史有': {'acc': 0.6, 'recall': 0.1667, 'f1': 0.2609, 'num': 18}, '疾病无': {'acc': 0, 'recall': 0.0, 'f1': 0.0, 'num': 3}, '检查结果阴性': {'acc': 0.0, 'recall': 0.0, 'f1': 0.0, 'num': 6}, '预防接种史有': {'acc': 0.0, 'recall': 0.0, 'f1': 0.0, 'num': 2}}
-> Valid. time: 33.2271s, loss: 32.3771, f1_score: 89.1711%

* Training epoch 14:
loss:4.9552001953125: 100%|██████████| 13/13 [00:14<00:00,  1.12s/it]
-> Training time: 14.6155s, loss = 3.9332, accuracy:
* Validation for epoch 14:
正在对验证集进行测试
{'acc': 0.8909250414270397, 'recall': 0.9022704837117473, 'f1': 0.89656187159743, 'num': 30390}
{'眼别': {'acc': 0.954, 'recall': 0.9797, 'f1': 0.9667, 'num': 4572}, '手术': {'acc': 0.8556, 'recall': 0.885, 'f1': 0.87, 'num': 904}, '时长': {'acc': 0.9298, 'recall': 0.9539, 'f1': 0.9417, 'num': 3817}, '症状有': {'acc': 0.8781, 'recall': 0.8846, 'f1': 0.8813, 'num': 6074}, '时间': {'acc': 0.5826, 'recall': 0.5222, 'f1': 0.5508, 'num': 270}, '疾病有': {'acc': 0.8808, 'recall': 0.9048, 'f1': 0.8927, 'num': 1135}, '症状无': {'acc': 0.9814, 'recall': 0.988, 'f1': 0.9847, 'num': 10158}, '操作或治疗有': {'acc': 0.4018, 'recall': 0.4412, 'f1': 0.4206, 'num': 408}, '规律': {'acc': 0.6246, 'recall': 0.6887, 'f1': 0.655, 'num': 1773}, '诱因': {'acc': 0.3972, 'recall': 0.3563, 'f1': 0.3756, 'num': 320}, '药物有': {'acc': 0.7917, 'recall': 0.8231, 'f1': 0.8071, 'num': 277}, '体征阳性': {'acc': 0.4671, 'recall': 0.3377, 'f1': 0.392, 'num': 231}, '检查项目': {'acc': 0.119, 'recall': 0.1136, 'f1': 0.1163, 'num': 44}, '检查结果阳性': {'acc': 0.0952, 'recall': 0.0952, 'f1': 0.0952, 'num': 42}, '方位': {'acc': 0.55, 'recall': 0.3571, 'f1': 0.4331, 'num': 154}, '体征阴性': {'acc': 0.1667, 'recall': 0.04, 'f1': 0.0645, 'num': 25}, '部位': {'acc': 0.2237, 'recall': 0.1735, 'f1': 0.1954, 'num': 98}, '手术史有': {'acc': 0.6, 'recall': 0.1667, 'f1': 0.2609, 'num': 18}, '拟行手术': {'acc': 0.4048, 'recall': 0.2881, 'f1': 0.3366, 'num': 59}, '检查结果阴性': {'acc': 0.0, 'recall': 0.0, 'f1': 0.0, 'num': 6}, '疾病无': {'acc': 0, 'recall': 0.0, 'f1': 0.0, 'num': 3}, '预防接种史有': {'acc': 0.0, 'recall': 0.0, 'f1': 0.0, 'num': 2}}
-> Valid. time: 33.4015s, loss: 32.2607, f1_score: 89.6562%

* Training epoch 15:
loss:3.0042521953582764: 100%|██████████| 13/13 [00:14<00:00,  1.15s/it]
-> Training time: 14.9888s, loss = 3.3484, accuracy:
* Validation for epoch 15:
正在对验证集进行测试
{'acc': 0.8884418197157505, 'recall': 0.9009542612701547, 'f1': 0.8946542935563979, 'num': 30390}
{'眼别': {'acc': 0.9507, 'recall': 0.9792, 'f1': 0.9648, 'num': 4572}, '症状有': {'acc': 0.8715, 'recall': 0.8876, 'f1': 0.8794, 'num': 6074}, '时长': {'acc': 0.9192, 'recall': 0.9628, 'f1': 0.9405, 'num': 3817}, '症状无': {'acc': 0.9795, 'recall': 0.9849, 'f1': 0.9822, 'num': 10158}, '规律': {'acc': 0.5966, 'recall': 0.6983, 'f1': 0.6435, 'num': 1773}, '疾病有': {'acc': 0.8781, 'recall': 0.9013, 'f1': 0.8896, 'num': 1135}, '诱因': {'acc': 0.4275, 'recall': 0.3688, 'f1': 0.396, 'num': 320}, '方位': {'acc': 0.573, 'recall': 0.3312, 'f1': 0.4198, 'num': 154}, '操作或治疗有': {'acc': 0.4254, 'recall': 0.4265, 'f1': 0.4259, 'num': 408}, '手术史有': {'acc': 0.8, 'recall': 0.2222, 'f1': 0.3478, 'num': 18}, '药物有': {'acc': 0.7924, 'recall': 0.8267, 'f1': 0.8092, 'num': 277}, '手术': {'acc': 0.8555, 'recall': 0.8838, 'f1': 0.8694, 'num': 904}, '时间': {'acc': 0.6379, 'recall': 0.4111, 'f1': 0.5, 'num': 270}, '体征阳性': {'acc': 0.463, 'recall': 0.2165, 'f1': 0.295, 'num': 231}, '拟行手术': {'acc': 0.3953, 'recall': 0.2881, 'f1': 0.3333, 'num': 59}, '体征阴性': {'acc': 0.0769, 'recall': 0.04, 'f1': 0.0526, 'num': 25}, '疾病无': {'acc': 0, 'recall': 0.0, 'f1': 0.0, 'num': 3}, '部位': {'acc': 0.3333, 'recall': 0.1327, 'f1': 0.1898, 'num': 98}, '预防接种史有': {'acc': 0.0, 'recall': 0.0, 'f1': 0.0, 'num': 2}, '检查结果阳性': {'acc': 0.0625, 'recall': 0.0476, 'f1': 0.0541, 'num': 42}, '检查项目': {'acc': 0.0645, 'recall': 0.0455, 'f1': 0.0533, 'num': 44}, '检查结果阴性': {'acc': 0.0, 'recall': 0.0, 'f1': 0.0, 'num': 6}}
-> Valid. time: 32.7960s, loss: 34.1363, f1_score: 89.4654%

  0%|          | 0/13 [00:00<?, ?it/s]* Training epoch 16:
loss:4.04498291015625: 100%|██████████| 13/13 [00:15<00:00,  1.16s/it]
-> Training time: 15.0802s, loss = 3.0658, accuracy:
* Validation for epoch 16:
正在对验证集进行测试
{'acc': 0.8914680663775959, 'recall': 0.8997696610727213, 'f1': 0.8955996266151353, 'num': 30390}
{'眼别': {'acc': 0.955, 'recall': 0.9786, 'f1': 0.9666, 'num': 4572}, '症状有': {'acc': 0.8821, 'recall': 0.8846, 'f1': 0.8834, 'num': 6074}, '时长': {'acc': 0.9314, 'recall': 0.9468, 'f1': 0.9391, 'num': 3817}, '症状无': {'acc': 0.9802, 'recall': 0.9885, 'f1': 0.9843, 'num': 10158}, '疾病有': {'acc': 0.8619, 'recall': 0.9075, 'f1': 0.8841, 'num': 1135}, '规律': {'acc': 0.6264, 'recall': 0.6554, 'f1': 0.6406, 'num': 1773}, '诱因': {'acc': 0.3706, 'recall': 0.3625, 'f1': 0.3665, 'num': 320}, '操作或治疗有': {'acc': 0.4153, 'recall': 0.4387, 'f1': 0.4267, 'num': 408}, '部位': {'acc': 0.2909, 'recall': 0.1633, 'f1': 0.2092, 'num': 98}, '体征阳性': {'acc': 0.4778, 'recall': 0.3723, 'f1': 0.4185, 'num': 231}, '手术': {'acc': 0.8495, 'recall': 0.8739, 'f1': 0.8615, 'num': 904}, '拟行手术': {'acc': 0.38, 'recall': 0.322, 'f1': 0.3486, 'num': 59}, '方位': {'acc': 0.5761, 'recall': 0.3442, 'f1': 0.4309, 'num': 154}, '时间': {'acc': 0.5382, 'recall': 0.5481, 'f1': 0.5431, 'num': 270}, '药物有': {'acc': 0.8, 'recall': 0.8375, 'f1': 0.8183, 'num': 277}, '手术史有': {'acc': 0.6, 'recall': 0.1667, 'f1': 0.2609, 'num': 18}, '体征阴性': {'acc': 0.2, 'recall': 0.04, 'f1': 0.0667, 'num': 25}, '检查项目': {'acc': 0.087, 'recall': 0.0909, 'f1': 0.0889, 'num': 44}, '检查结果阳性': {'acc': 0.0968, 'recall': 0.0714, 'f1': 0.0822, 'num': 42}, '检查结果阴性': {'acc': 0.0, 'recall': 0.0, 'f1': 0.0, 'num': 6}, '预防接种史有': {'acc': 0.0, 'recall': 0.0, 'f1': 0.0, 'num': 2}, '疾病无': {'acc': 0, 'recall': 0.0, 'f1': 0.0, 'num': 3}}
-> Valid. time: 32.9029s, loss: 34.0230, f1_score: 89.5600%

* Training epoch 17:
loss:2.6396076679229736: 100%|██████████| 13/13 [00:14<00:00,  1.13s/it]
-> Training time: 14.6387s, loss = 2.7369, accuracy:
* Validation for epoch 17:
正在对验证集进行测试
{'acc': 0.8901948051948052, 'recall': 0.9022046725896676, 'f1': 0.8961595031867953, 'num': 30390}
{'眼别': {'acc': 0.9504, 'recall': 0.9799, 'f1': 0.9649, 'num': 4572}, '方位': {'acc': 0.5506, 'recall': 0.3182, 'f1': 0.4033, 'num': 154}, '症状有': {'acc': 0.8711, 'recall': 0.8938, 'f1': 0.8823, 'num': 6074}, '时长': {'acc': 0.9235, 'recall': 0.9547, 'f1': 0.9388, 'num': 3817}, '症状无': {'acc': 0.9831, 'recall': 0.9882, 'f1': 0.9856, 'num': 10158}, '规律': {'acc': 0.6141, 'recall': 0.6723, 'f1': 0.6419, 'num': 1773}, '时间': {'acc': 0.6035, 'recall': 0.5074, 'f1': 0.5513, 'num': 270}, '疾病有': {'acc': 0.871, 'recall': 0.9101, 'f1': 0.8901, 'num': 1135}, '手术': {'acc': 0.8567, 'recall': 0.8728, 'f1': 0.8647, 'num': 904}, '操作或治疗有': {'acc': 0.4159, 'recall': 0.4485, 'f1': 0.4316, 'num': 408}, '部位': {'acc': 0.2609, 'recall': 0.1224, 'f1': 0.1667, 'num': 98}, '体征阳性': {'acc': 0.4537, 'recall': 0.2121, 'f1': 0.2891, 'num': 231}, '检查结果阳性': {'acc': 0.0909, 'recall': 0.0714, 'f1': 0.08, 'num': 42}, '诱因': {'acc': 0.4032, 'recall': 0.3906, 'f1': 0.3968, 'num': 320}, '检查项目': {'acc': 0.1026, 'recall': 0.0909, 'f1': 0.0964, 'num': 44}, '药物有': {'acc': 0.7816, 'recall': 0.8267, 'f1': 0.8035, 'num': 277}, '拟行手术': {'acc': 0.4615, 'recall': 0.3051, 'f1': 0.3673, 'num': 59}, '体征阴性': {'acc': 0.25, 'recall': 0.04, 'f1': 0.069, 'num': 25}, '预防接种史有': {'acc': 0.0, 'recall': 0.0, 'f1': 0.0, 'num': 2}, '手术史有': {'acc': 0.6, 'recall': 0.1667, 'f1': 0.2609, 'num': 18}, '检查结果阴性': {'acc': 0.0, 'recall': 0.0, 'f1': 0.0, 'num': 6}, '疾病无': {'acc': 0, 'recall': 0.0, 'f1': 0.0, 'num': 3}}
-> Valid. time: 32.5223s, loss: 34.8866, f1_score: 89.6160%

* Training epoch 18:
loss:1.4783189296722412: 100%|██████████| 13/13 [00:15<00:00,  1.15s/it]
-> Training time: 15.0116s, loss = 2.4817, accuracy:
* Validation for epoch 18:
正在对验证集进行测试
{'acc': 0.8902915148360229, 'recall': 0.9004277722935176, 'f1': 0.8953309557307856, 'num': 30390}
{'眼别': {'acc': 0.9528, 'recall': 0.9799, 'f1': 0.9661, 'num': 4572}, '症状有': {'acc': 0.8807, 'recall': 0.8798, 'f1': 0.8803, 'num': 6074}, '时长': {'acc': 0.9248, 'recall': 0.9599, 'f1': 0.942, 'num': 3817}, '症状无': {'acc': 0.9786, 'recall': 0.989, 'f1': 0.9837, 'num': 10158}, '时间': {'acc': 0.6383, 'recall': 0.4444, 'f1': 0.524, 'num': 270}, '疾病有': {'acc': 0.8752, 'recall': 0.9084, 'f1': 0.8915, 'num': 1135}, '操作或治疗有': {'acc': 0.4282, 'recall': 0.4387, 'f1': 0.4334, 'num': 408}, '规律': {'acc': 0.6068, 'recall': 0.6746, 'f1': 0.6389, 'num': 1773}, '诱因': {'acc': 0.4164, 'recall': 0.3969, 'f1': 0.4064, 'num': 320}, '体征阳性': {'acc': 0.5, 'recall': 0.2684, 'f1': 0.3493, 'num': 231}, '手术': {'acc': 0.8435, 'recall': 0.8761, 'f1': 0.8595, 'num': 904}, '手术史有': {'acc': 0.6, 'recall': 0.1667, 'f1': 0.2609, 'num': 18}, '方位': {'acc': 0.5152, 'recall': 0.3312, 'f1': 0.4032, 'num': 154}, '部位': {'acc': 0.1846, 'recall': 0.1224, 'f1': 0.1472, 'num': 98}, '体征阴性': {'acc': 0.1429, 'recall': 0.04, 'f1': 0.0625, 'num': 25}, '预防接种史有': {'acc': 0.0, 'recall': 0.0, 'f1': 0.0, 'num': 2}, '药物有': {'acc': 0.7782, 'recall': 0.8231, 'f1': 0.8, 'num': 277}, '检查项目': {'acc': 0.125, 'recall': 0.1364, 'f1': 0.1304, 'num': 44}, '拟行手术': {'acc': 0.4318, 'recall': 0.322, 'f1': 0.3689, 'num': 59}, '检查结果阳性': {'acc': 0.0714, 'recall': 0.0714, 'f1': 0.0714, 'num': 42}, '检查结果阴性': {'acc': 0.0, 'recall': 0.0, 'f1': 0.0, 'num': 6}, '疾病无': {'acc': 0, 'recall': 0.0, 'f1': 0.0, 'num': 3}}
-> Valid. time: 33.2581s, loss: 36.2130, f1_score: 89.5331%

* Training epoch 19:
loss:1.7335611581802368: 100%|██████████| 13/13 [00:14<00:00,  1.13s/it]
-> Training time: 14.6771s, loss = 2.3367, accuracy:
* Validation for epoch 19:
正在对验证集进行测试
{'acc': 0.8884286823712141, 'recall': 0.9034550839091806, 'f1': 0.8958788788462166, 'num': 30390}
{'眼别': {'acc': 0.9502, 'recall': 0.9799, 'f1': 0.9648, 'num': 4572}, '症状有': {'acc': 0.8678, 'recall': 0.8945, 'f1': 0.8809, 'num': 6074}, '时长': {'acc': 0.925, 'recall': 0.9528, 'f1': 0.9387, 'num': 3817}, '症状无': {'acc': 0.9833, 'recall': 0.988, 'f1': 0.9857, 'num': 10158}, '规律': {'acc': 0.6086, 'recall': 0.6971, 'f1': 0.6498, 'num': 1773}, '时间': {'acc': 0.5921, 'recall': 0.5, 'f1': 0.5422, 'num': 270}, '手术': {'acc': 0.8469, 'recall': 0.875, 'f1': 0.8607, 'num': 904}, '操作或治疗有': {'acc': 0.4286, 'recall': 0.4412, 'f1': 0.4348, 'num': 408}, '体征阳性': {'acc': 0.4773, 'recall': 0.2727, 'f1': 0.3471, 'num': 231}, '疾病有': {'acc': 0.8839, 'recall': 0.9057, 'f1': 0.8947, 'num': 1135}, '检查项目': {'acc': 0.1351, 'recall': 0.1136, 'f1': 0.1235, 'num': 44}, '检查结果阳性': {'acc': 0.0278, 'recall': 0.0238, 'f1': 0.0256, 'num': 42}, '诱因': {'acc': 0.4, 'recall': 0.3625, 'f1': 0.3803, 'num': 320}, '拟行手术': {'acc': 0.4038, 'recall': 0.3559, 'f1': 0.3784, 'num': 59}, '方位': {'acc': 0.5263, 'recall': 0.3247, 'f1': 0.4016, 'num': 154}, '部位': {'acc': 0.25, 'recall': 0.1327, 'f1': 0.1733, 'num': 98}, '药物有': {'acc': 0.7828, 'recall': 0.8195, 'f1': 0.8007, 'num': 277}, '预防接种史有': {'acc': 0.0, 'recall': 0.0, 'f1': 0.0, 'num': 2}, '体征阴性': {'acc': 0.2, 'recall': 0.04, 'f1': 0.0667, 'num': 25}, '手术史有': {'acc': 0.6, 'recall': 0.1667, 'f1': 0.2609, 'num': 18}, '疾病无': {'acc': 0, 'recall': 0.0, 'f1': 0.0, 'num': 3}, '检查结果阴性': {'acc': 0.0, 'recall': 0.0, 'f1': 0.0, 'num': 6}}
-> Valid. time: 33.7793s, loss: 34.8620, f1_score: 89.5879%

  0%|          | 0/13 [00:00<?, ?it/s]* Training epoch 20:
loss:1.8181424140930176: 100%|██████████| 13/13 [00:14<00:00,  1.13s/it]
-> Training time: 14.6756s, loss = 2.1174, accuracy:
* Validation for epoch 20:
正在对验证集进行测试
{'acc': 0.8919209002797112, 'recall': 0.9023692003948667, 'f1': 0.8971146296780949, 'num': 30390}
{'眼别': {'acc': 0.9488, 'recall': 0.9812, 'f1': 0.9647, 'num': 4572}, '规律': {'acc': 0.6173, 'recall': 0.6768, 'f1': 0.6457, 'num': 1773}, '症状有': {'acc': 0.8795, 'recall': 0.89, 'f1': 0.8847, 'num': 6074}, '时长': {'acc': 0.9192, 'recall': 0.9594, 'f1': 0.9389, 'num': 3817}, '症状无': {'acc': 0.9841, 'recall': 0.988, 'f1': 0.986, 'num': 10158}, '疾病有': {'acc': 0.8738, 'recall': 0.9093, 'f1': 0.8912, 'num': 1135}, '操作或治疗有': {'acc': 0.4425, 'recall': 0.4436, 'f1': 0.4431, 'num': 408}, '药物有': {'acc': 0.7973, 'recall': 0.8375, 'f1': 0.8169, 'num': 277}, '时间': {'acc': 0.6575, 'recall': 0.4407, 'f1': 0.5277, 'num': 270}, '手术': {'acc': 0.8518, 'recall': 0.8772, 'f1': 0.8643, 'num': 904}, '方位': {'acc': 0.5543, 'recall': 0.3312, 'f1': 0.4146, 'num': 154}, '体征阳性': {'acc': 0.4859, 'recall': 0.2987, 'f1': 0.37, 'num': 231}, '疾病无': {'acc': 0, 'recall': 0.0, 'f1': 0.0, 'num': 3}, '诱因': {'acc': 0.375, 'recall': 0.3375, 'f1': 0.3553, 'num': 320}, '体征阴性': {'acc': 0.1111, 'recall': 0.04, 'f1': 0.0588, 'num': 25}, '拟行手术': {'acc': 0.3962, 'recall': 0.3559, 'f1': 0.375, 'num': 59}, '部位': {'acc': 0.2105, 'recall': 0.1224, 'f1': 0.1548, 'num': 98}, '检查结果阳性': {'acc': 0.125, 'recall': 0.1429, 'f1': 0.1333, 'num': 42}, '检查项目': {'acc': 0.1064, 'recall': 0.1136, 'f1': 0.1099, 'num': 44}, '手术史有': {'acc': 0.6, 'recall': 0.1667, 'f1': 0.2609, 'num': 18}, '检查结果阴性': {'acc': 0.0, 'recall': 0.0, 'f1': 0.0, 'num': 6}, '预防接种史有': {'acc': 0.0, 'recall': 0.0, 'f1': 0.0, 'num': 2}}
-> Valid. time: 33.4121s, loss: 35.6308, f1_score: 89.7115%


进程已结束,退出代码0
